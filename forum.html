<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>F√≥rum - EducaF√°cil</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
</head>
<body id="page-body">

<!-- WIDGET DE ACESSIBILIDADE (NOVO) -->
<div id="accessibility-widget" class="ac-widget ac-hidden" aria-hidden="true">
    <div class="ac-header">
        <div class="ac-header-top">
            <span class="ac-title">Menu Acessibilidade (CTRL+U)</span>
            <button id="ac-close-btn" class="ac-icon-btn" aria-label="Fechar menu de acessibilidade">√ó</button>
        </div>

        <div class="ac-select-row">
            <button class="ac-pill" id="ac-lang-btn">Portugu√™s (Brasil)</button>
            <button class="ac-pill ac-pill-active" id="ac-profile-btn">Dislexia perfil ativo</button>
        </div>

        <div class="ac-select-row">
            <button class="ac-pill ac-pill-xl ac-pill-active" id="ac-widget-size-btn">
                XL Widget superdimensionado
            </button>
        </div>
    </div>

    <div class="ac-profiles-section">
        <div class="ac-profiles-header">
            <span>Perfis de acessibilidade</span>
        </div>
        <div class="ac-profiles-grid">
            <button class="ac-profile" data-profile="deficiencia-motora">Defici√™ncia Motora</button>
            <button class="ac-profile" data-profile="cego">Cego</button>
            <button class="ac-profile" data-profile="daltonico">Dalt√¥nico</button>
            <button class="ac-profile" data-profile="dislexia">Dislexia</button>
            <button class="ac-profile" data-profile="baixa-visao">Baixa vis√£o</button>
            <button class="ac-profile" data-profile="cognitivo">Cognitivo</button>
            <button class="ac-profile" data-profile="convulsao">Convuls√£o</button>
            <button class="ac-profile" data-profile="tdah">TDAH</button>
        </div>
    </div>

    <div class="ac-grid">
        <button id="ac-ler-pagina" class="ac-item"><span class="ac-item-title">Ler a p√°gina</span></button>
        <button id="ac-contraste-mais" class="ac-item"><span class="ac-item-title">Contraste +</span></button>
        <button id="ac-contraste-inteligente" class="ac-item"><span class="ac-item-title">Contraste inteligente</span></button>
        <button id="ac-links-destacados" class="ac-item"><span class="ac-item-title">Links destacados</span></button>
        <button id="ac-texto-maior" class="ac-item"><span class="ac-item-title">Texto maior</span></button>
        <button id="ac-espacamento-texto" class="ac-item"><span class="ac-item-title">Espa√ßamento de texto</span></button>
        <button id="ac-animacoes" class="ac-item"><span class="ac-item-title">Reproduzir anima√ß√µes</span></button>
        <button id="ac-ocultar-imagens" class="ac-item"><span class="ac-item-title">Ocultar imagens</span></button>
        <button id="ac-dislexia" class="ac-item"><span class="ac-item-title">Df Dislexia amig√°vel</span></button>
        <button id="ac-cursor" class="ac-item"><span class="ac-item-title">Cursor</span></button>
        <button id="ac-barra-ferramentas" class="ac-item"><span class="ac-item-title">Barra de ferramentas</span></button>
        <button id="ac-estrutura-pagina" class="ac-item"><span class="ac-item-title">Estrutura da p√°gina</span></button>
        <button id="ac-altura-linha" class="ac-item"><span class="ac-item-title">Altura da linha</span></button>
        <button id="ac-alinhamento-texto" class="ac-item"><span class="ac-item-title">Alinhamento de texto</span></button>
        <button id="ac-saturacao" class="ac-item"><span class="ac-item-title">Satura√ß√£o</span></button>
    </div>

    <div class="ac-footer">
        <button id="ac-reset" class="ac-reset-btn">Redefinir todas as configura√ß√µes</button>
        <button id="ac-toggle-visibility" class="ac-move-btn">Mover/ocultar widget</button>
    </div>
</div>

<!-- BOT√ÉO FLUTUANTE -->
<button id="accessibility-btn" class="ac-fab" aria-label="Abrir menu de acessibilidade">
    <img src="https://api.iconify.design/material-symbols/accessibility-new.svg?color=%23ffffff" alt="√çcone de acessibilidade">
</button>

<div class="dashboard-layout">

    <!-- SIDEBAR -->
    <div class="sidebar">
        <div class="profile-box">
            <img id="aluno-foto" src="https://i.imgur.com/gKjG1o2.png" alt="Foto do aluno">
            <p id="aluno-nome" class="aluno-name">Aluno</p>
            <p id="aluno-email" class="aluno-email">aluno.ic9@educ.edu.br</p>
        </div>

        <nav class="sidebar-nav">
            <div class="nav-item"><a href="home.html">üè† Home</a></div>
            <div class="nav-item active"><a href="forum.html">üí¨ F√≥rum</a></div>
            <div class="nav-item"><a href="aulas.html">‚ñ∂Ô∏è Aulas</a></div>
            <div class="nav-item"><a href="conteudos.html">üìö Conte√∫dos</a></div>
            <div class="nav-item"><a href="exercicios.html">üìù Exerc√≠cios</a></div>
            <div class="nav-item"><a href="configuracoes.html">‚öôÔ∏è Configura√ß√µes</a></div>
            <div class="nav-item"><a href="certificados.html">üèÖ Certificados</a></div>
        </nav>

        <input type="text" placeholder="Pesquisar no f√≥rum"
               style="margin: 20px 15px; padding: 8px; border-radius: 10px; border: none; width: calc(100% - 30px); opacity: 0.8;">
    </div>

    <!-- MAIN CONTENT -->
    <div class="main-content">
        <div class="main-content-area forum-main">
            <h1>F√≥rum de Programa√ß√£o de Computadores e Algoritmos</h1>
            <p aria-live="polite">Tire d√∫vidas, compartilhe solu√ß√µes e ajude outros colegas.</p>

            <div class="forum-layout">
                <!-- LISTA DE T√ìPICOS -->
                <div class="card-simple forum-list-card">
                    <h3>T√≥picos do f√≥rum</h3>
                    <div id="forum-topics"></div>
                </div>

                <!-- FORMUL√ÅRIO DE NOVO T√ìPICO -->
                <div class="card-simple forum-form-card">
                    <h3>Criar novo t√≥pico</h3>

                    <form id="forum-form">
                        <div class="forum-input-group">
                            <label for="forum-title">T√≠tulo do t√≥pico</label>
                            <input id="forum-title" type="text" required>
                        </div>

                        <div class="forum-input-group">
                            <label for="forum-aula">Relacionado √† aula</label>
                            <select id="forum-aula" required>
                                <option value="Geral">Geral</option>
                                <option value="Aula 1 ‚Äì Introdu√ß√£o a Algoritmos">Aula 1 ‚Äì Introdu√ß√£o a Algoritmos</option>
                                <option value="Aula 2 ‚Äì Vari√°veis e Operadores">Aula 2 ‚Äì Vari√°veis e Operadores</option>
                                <option value="Aula 3 ‚Äì Estruturas de Decis√£o">Aula 3 ‚Äì Estruturas de Decis√£o</option>
                                <option value="Aula 4 ‚Äì Estruturas de Repeti√ß√£o">Aula 4 ‚Äì Estruturas de Repeti√ß√£o</option>
                                <option value="Aula 5 ‚Äì Vetores e Matrizes">Aula 5 ‚Äì Vetores e Matrizes</option>
                                <option value="Aula 6 ‚Äì Resolu√ß√£o de Problemas">Aula 6 ‚Äì Resolu√ß√£o de Problemas</option>
                            </select>
                        </div>

                        <div class="forum-input-group">
                            <label for="forum-message">Mensagem</label>
                            <textarea id="forum-message" rows="5" required></textarea>
                        </div>

                        <button type="submit" class="forum-btn">Publicar t√≥pico</button>
                    </form>

                    <p id="forum-feedback" aria-live="polite" class="forum-feedback"></p>
                </div>
            </div>
        </div>
    </div>

</div>

<div id="talkback-container" class="hidden">
    <div class="bot-icon">üîä</div>
    <p id="talkback-message">Talkback ativado.</p>
</div>

<script src="script.js"></script>

<script>
// Layout extra do forum (inputs e bot√µes mais bonitos)
const style = document.createElement('style');
style.textContent = `
.forum-main h1 { margin-bottom: 4px; }
.forum-layout {
    display: grid;
    grid-template-columns: 2fr 1.2fr;
    gap: 18px;
    margin-top: 14px;
}
.forum-list-card, .forum-form-card { min-height: 300px; }
.forum-topic {
    border-radius: 10px;
    border: 1px solid #e0e0e0;
    padding: 10px 12px;
    margin-bottom: 10px;
    background: #fafbff;
}
.forum-topic-title {
    font-weight: 600;
    margin: 0 0 4px;
}
.forum-topic-meta {
    font-size: 12px;
    opacity: 0.8;
    margin-bottom: 6px;
}
.forum-reply {
    margin-left: 10px;
    margin-top: 4px;
    padding-left: 8px;
    border-left: 2px solid #d0d0ff;
    font-size: 13px;
}
.forum-input-group {
    margin-bottom: 10px;
}
.forum-input-group label {
    display: block;
    font-size: 13px;
    margin-bottom: 4px;
}
.forum-input-group input,
.forum-input-group select,
.forum-input-group textarea {
    width: 100%;
    padding: 8px 10px;
    border-radius: 8px;
    border: 1px solid #d0d3e6;
    font-size: 14px;
}
.forum-input-group input:focus,
.forum-input-group select:focus,
.forum-input-group textarea:focus {
    outline: none;
    border-color: #4a4ae6;
    box-shadow: 0 0 0 2px rgba(74,74,230,0.25);
}
.forum-btn {
    width: 100%;
    border: none;
    border-radius: 999px;
    padding: 9px 0;
    background: linear-gradient(135deg, #4a4ae6, #6366f1);
    color: #fff;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
}
.forum-btn:hover {
    opacity: 0.95;
}
.forum-feedback {
    margin-top: 8px;
    font-size: 13px;
}
.forum-reply-form {
    margin-top: 6px;
}
.forum-reply-form textarea {
    width: 100%;
    padding: 6px 8px;
    border-radius: 6px;
    border: 1px solid #d0d3e6;
    font-size: 13px;
}
.forum-reply-form button {
    margin-top: 4px;
    border: none;
    border-radius: 999px;
    padding: 4px 10px;
    background: #4a4ae6;
    color: #fff;
    font-size: 12px;
    cursor: pointer;
}
`;
document.head.appendChild(style);

// Dados do aluno para exibir como autor padr√£o
const alunoNome  = localStorage.getItem('perfil_nome')  || 'Aluno';
const alunoFoto  = localStorage.getItem('perfil_foto')  || 'https://i.imgur.com/gKjG1o2.png';
const alunoEmail = localStorage.getItem('perfil_email') || 'aluno.ic9@educ.edu.br';
document.getElementById('aluno-nome').textContent  = alunoNome;
document.getElementById('aluno-email').textContent = alunoEmail;
document.getElementById('aluno-foto').src         = alunoFoto;

// --- F√ìRUM FUNCIONAL COM localStorage ---
const TOPICS_KEY = 'forum_topicos_v1';

// Estrutura: [{id, titulo, aula, msg, autor, data, respostas: [{autor, msg, data}]}]

function carregarTopicos() {
    const raw = localStorage.getItem(TOPICS_KEY);
    try {
        return raw ? JSON.parse(raw) : [];
    } catch {
        return [];
    }
}

function salvarTopicos(lista) {
    localStorage.setItem(TOPICS_KEY, JSON.stringify(lista));
}

function renderizarTopicos() {
    const container = document.getElementById('forum-topics');
    container.innerHTML = '';

    const topicos = carregarTopicos();
    if (topicos.length === 0) {
        const vazio = document.createElement('p');
        vazio.textContent = 'Nenhum t√≥pico criado ainda. Seja o primeiro a perguntar!';
        vazio.style.fontSize = '13px';
        vazio.style.opacity = '0.8';
        container.appendChild(vazio);
        return;
    }

    topicos.forEach((topico, index) => {
        const div = document.createElement('div');
        div.className = 'forum-topic';

        const h4 = document.createElement('h4');
        h4.className = 'forum-topic-title';
        h4.textContent = topico.titulo;
        div.appendChild(h4);

        const meta = document.createElement('p');
        meta.className = 'forum-topic-meta';
        meta.textContent = `${topico.autor} ¬∑ ${topico.aula} ¬∑ ${topico.data}`;
        div.appendChild(meta);

        const msg = document.createElement('p');
        msg.textContent = topico.msg;
        div.appendChild(msg);

        // respostas
        if (topico.respostas && topico.respostas.length > 0) {
            topico.respostas.forEach(r => {
                const rDiv = document.createElement('div');
                rDiv.className = 'forum-reply';
                rDiv.textContent = `${r.autor} (${r.data}): ${r.msg}`;
                div.appendChild(rDiv);
            });
        }

        // formul√°rio de resposta
        const replyForm = document.createElement('form');
        replyForm.className = 'forum-reply-form';
        replyForm.onsubmit = (e) => {
            e.preventDefault();
            const textarea = replyForm.querySelector('textarea');
            const texto = textarea.value.trim();
            if (!texto) return;

            const lista = carregarTopicos();
            const t = lista[index];
            if (!t.respostas) t.respostas = [];
            t.respostas.push({
                autor: alunoNome,
                msg: texto,
                data: new Date().toLocaleString('pt-BR')
            });
            salvarTopicos(lista);
            renderizarTopicos();
        };

        const replyTextarea = document.createElement('textarea');
        replyTextarea.rows = 2;
        replyTextarea.placeholder = 'Responder a este t√≥pico...';
        replyForm.appendChild(replyTextarea);

        const replyBtn = document.createElement('button');
        replyBtn.type = 'submit';
        replyBtn.textContent = 'Responder';
        replyForm.appendChild(replyBtn);

        div.appendChild(replyForm);

        container.appendChild(div);
    });
}

// Inicializar
document.addEventListener('DOMContentLoaded', () => {
    renderizarTopicos();

    const form = document.getElementById('forum-form');
    const feedback = document.getElementById('forum-feedback');

    form.addEventListener('submit', (e) => {
        e.preventDefault();
        const titulo  = document.getElementById('forum-title').value.trim();
        const aula    = document.getElementById('forum-aula').value;
        const mensagem= document.getElementById('forum-message').value.trim();

        if (!titulo || !mensagem) {
            feedback.textContent = 'Preencha t√≠tulo e mensagem antes de publicar.';
            feedback.style.color = '#c62828';
            return;
        }

        const lista = carregarTopicos();
        lista.unshift({
            id: Date.now(),
            titulo,
            aula,
            msg: mensagem,
            autor: alunoNome,
            data: new Date().toLocaleString('pt-BR'),
            respostas: []
        });
        salvarTopicos(lista);

        feedback.textContent = 'T√≥pico publicado com sucesso!';
        feedback.style.color = '#2e7d32';
        form.reset();
        renderizarTopicos();
    });
});
</script>

</body>
</html>
